
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">

<title>腕立て伏せカウンター|カメラで自動カウントできる無料Webアプリ</title>

<meta name="description" content="スマホやPCのカメラで腕立て伏せの回数を自動でカウントできる無料Webアプリ。インストール不要、目標回数設定、音通知、PWA対応。">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="index, follow">

<link rel="canonical" href="https://muscle-trainer.github.io/pushupcounter/">

<meta name="theme-color" content="#0d6efd">
<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<style>
body {
  font-family: system-ui, sans-serif;
  margin: 0;
  padding: 12px;
  background: #f5f5f5;
}

h1 {
  font-size: 1.6rem;
  text-align: center;
}

h2 {
  margin-top: 24px;
}

video {
  width: 100%;
  max-width: 480px;
  display: block;
  margin: 0 auto;
  border-radius: 12px;
}

button, input {
  font-size: 1rem;
  padding: 10px;
  margin: 4px;
}

.counter {
  text-align: center;
  font-size: 2rem;
  margin: 10px;
}

.warning {
  display: none;
  background: #ffecec;
  color: #900;
  padding: 10px;
  margin-bottom: 10px;
}
</style>
</head>

<body>

<div id="line-warning" class="warning">
⚠ このサイトは LINEアプリ内ブラウザではカメラが使用できません。<br>
右上「︙」→「ブラウザで開く」を選択してください。
</div>

<h1>腕立て伏せ自動カウンター</h1>

<p style="text-align:center;">
スマートフォンやパソコンのカメラを使って<br>
腕立て伏せの回数を自動でカウントする無料Webアプリです。
</p>

<video id="video" playsinline></video>

<div class="counter">
回数：<span id="count">0</span>
</div>

<div style="text-align:center;">
目標回数：
<input type="number" id="target" value="10" min="1">
</div>

<div style="text-align:center;">
<button id="start">スタート</button>
<button id="pause">一時停止</button>
<button id="reset">リセット</button>
</div>

<section>
<h2>このサイトについて</h2>
<p>
このサイトは、MediaPipe Pose を用いた姿勢推定技術により、
ユーザーの動作を解析し、腕立て伏せ（プッシュアップ）の回数を
自動でカウントする無料のWebアプリです。
</p>
<p>
インストール不要で、スマートフォンやパソコンのブラウザから
すぐに利用できます。目標回数の設定や、カウント時・目標達成時の
音通知にも対応しています。
</p>
</section>

<section>
<h2>使い方</h2>
<ol>
<li>カメラに対して正面を向きます</li>
<li>スタートボタンを押します</li>
<li>腕立て伏せを行うと自動で回数がカウントされます</li>
<li>目標回数に到達すると通知音が鳴ります</li>
</ol>
</section>

<section>
<h2>注意事項</h2>
<ul>
<li>LINEアプリ内ブラウザではカメラが使用できません</li>
<li>カメラ使用許可を必ず許可してください</li>
<li>十分な明るさのある環境で使用してください</li>
</ul>
</section>

<script>
/* LINE内ブラウザ検出 */
if (/Line/i.test(navigator.userAgent)) {
  document.getElementById("line-warning").style.display = "block";
}

/* 音 */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function beep(freq, duration) {
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.frequency.value = freq;
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.start();
  gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
  osc.stop(audioCtx.currentTime + duration);
}

let count = 0;
let running = false;
let position = null;

const countEl = document.getElementById("count");
const targetEl = document.getElementById("target");

const pose = new Pose({
  locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`
});

pose.setOptions({
  minDetectionConfidence: 0.7,
  minTrackingConfidence: 0.7
});

pose.onResults(results => {
  if (!running || !results.poseLandmarks) return;

  const lm = results.poseLandmarks;
  if (lm[12].y > lm[14].y && lm[11].y > lm[13].y) position = "down";

  if (lm[12].y < lm[14].y && lm[11].y < lm[13].y && position === "down") {
    position = "up";
    count++;
    countEl.textContent = count;
    beep(900, 0.15);

    if (count >= Number(targetEl.value)) {
      beep(400, 0.6);
      running = false;
      alert("目標達成！");
    }
  }
});

const video = document.getElementById("video");

const camera = new Camera(video, {
  onFrame: async () => {
    await pose.send({ image: video });
  },
  width: 640,
  height: 480
});

camera.start().catch(() => {
  alert("カメラを起動できません。ブラウザで開いているか確認してください。");
});

document.getElementById("start").onclick = () => {
  audioCtx.resume();
  running = true;
};
document.getElementById("pause").onclick = () => running = false;
document.getElementById("reset").onclick = () => {
  running = false;
  count = 0;
  position = null;
  countEl.textContent = 0;
};
</script>

</body>
</html>
